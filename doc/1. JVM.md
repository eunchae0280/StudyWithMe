# JVM이란 무엇인지 알아보자.
## JVM이란??  
자바 가상 머신의 약자. 자바 바이트코드를 실행하는 실행기. 
시스템메모리를 관리하면서 자바기반 어플리케이션을 위해 실행 가능한 환경을 제공한다.
JAVA와 OS사이의 중개자 역할. OS에 구애받지 않고 자바가 재사용 가능하도록 한다.
JVM은 스택기반의 가상머신.
메모리관리, Garbage collection을 수행한다.
	
## 자바가 컴파일 후 실행하는 방법
1. [참조1]프로그램이 실행되면 JVM은 OS로부터 필요로하는 메모리를 할당받는다.(JVM은 이 메모리를 용도에따라 여러 영역으로 나누어 관리)-뒤에서 계속...
2. 자바 컴파일러 javac가 자바소스.java를 읽어 자바 바이트코드.class로 변환시킨다.
3. Class Loader를 통해 class파일들(컴파일된 파일)을 JVM으로 로딩한다.
4. 로딩된 class파일들은 Execution engine을 통해 해석된다.
5. 해석된 바이트코드는 Runtime Data Area에 배치되어 수행이 이루어 진다.
	
## JVM의 구성
* Class Loader(클래스로더)  
JVM내로 클래스파일을 로드하고, 링크를 통해 배치하는 역할. 
자바는 동적코드-> Runtime시에 동적으로 클래스를 로드한다-> 자바는 컴파일타임이 아니라 런타임에 참조한다-> 클래스를 처음으로 참조할 때 해당 클래스를 로드하고 링크한다.
(개발자 입장에서 클래스로더의 매커니즘은 블랙박스..)
		
* Execution engine(실행엔진)  
클래스를 실행시키는 역할. 실행엔진은 바이트코드를 실제로 JVM내부에서 실행될 수 있는 형태로 변경한다. 이때 두가지 방법이 있다
		
* Interpreter vs JIT(Just-In-Time)   
	* Interpreter
	실행엔진은 자바 바이트코드를 명령어 단위로 읽어서 실행한다. 한줄씩 읽어 수행하면 느리다는 단점이 있다.
				
	* JIT(Just-In-Time)  
	인터프리터 방식을 보완하기 위한 방법. 인터프리터 방식으로 실행하다 적절한 타임에 바이트코드 전체를 컴파일하여 네이티브 코드로 변경하고, 이후에는 인터프리팅 하지 않고 네이티브 코드로 실행한다.
	네이티브 코드는 캐시에 보관하기 때문에 빠르게 수행 가능. JIT컴파일러가 컴파일하는 시간은 인터프리팅하는 것보다 훨씬 오래걸리므로 한번만 실행되는 파일같은 경우는 인터프리팅이 유리. 
	JVM이 내부적으로 메소드가 얼마나 자주 사용되는지 파악하고 일정 정도를 넘을때만 컴파일 한다.
		
* Garbage Collector  

## [참조1]JVM의 메모리 영역  
프로그램을 수행하기위해 OS에서 할당받은 메모리 공간.
		
![img](https://github.com/eunchae0280/StudyWithMe/blob/eunch/doc/JVMmemory.JPG)
	
* JVM의 스택영역
프로그램 실행과정에서 임시로 할당되었다가 메소드를 빠져나가면 바로 소멸되는 특성의 데이터를 저장하기 위한 영역. 함수, 변수, 임시데이터, 스레드, 메소드정보 저장.
메소드 호출시 메소드만의 공간이 생성되고 메소드 안에서 사용되는 local변수를 저장. 메소드가 끝나면 그 공간을 삭제. 
메소드 호출시에 사용된 매개변수, 리턴값, 연산시 발생하는 값들을 임시로 저장.
		
* Native method stack
컴파일된 바이트코드가 아닌 실제 실행할 수 있는 기계어로 작성된 프로그램을 실행시키는 영역.
		
* Method Area(=Class Area, Static Area)-GC대상
	클래스 정보를 처음 메모리에 올릴때 초기화 되는 대상을 저장하기 위한 공간. 
		
* Heap-GC대상
	클래스 객체를 위한 저장공간. new연산자로 생성된 객체와 배열을 저장한다. class area에 올라온 클래스의 객체만 만들 수 있다. 
	
## JDK와 JRE
* JRE
자바 실행환경의 약자. JVM이 자바프로그램을 실행시킬때 필요한 라이브러리 파일들과 기타 파일들을 가지고 있다.   

* JDK
자바 개발도구의 약자. JRE와 자바개발에 필요한 도구(javac,java 등)를 포함한다.  
![img](https://github.com/eunchae0280/StudyWithMe/blob/eunch/doc/jdk.JPG)
	
[출처]https://asfirstalways.tistory.com/158
[출처]https://wikidocs.net/257